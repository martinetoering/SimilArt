<!-- base.html -->

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">
	<title>{% block title %}{% endblock %}</title>

	<!-- Bootstrap core CSS -->
	<link href="https://getbootstrap.com/docs/4.0/dist/css/bootstrap.min.css" rel="stylesheet">

	<!-- D3 package -->
	<script src="https://d3js.org/d3.v5.min.js"></script>

	<!-- Bokeh CSS -->
	<link rel="stylesheet" href="https://cdn.bokeh.org/bokeh/release/bokeh-1.4.0.min.css" type="text/css" />
	<link rel="stylesheet" href="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-1.4.0.min.css" type="text/css" />
	<link rel="stylesheet" href="https://cdn.bokeh.org/bokeh/release/bokeh-tables-1.4.0.min.css" type="text/css">

	<!-- Bokeh scripts -->
	<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-1.4.0.min.js"></script>
	<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-1.4.0.min.js"></script>
	<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-1.4.0.min.js"></script>
	<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-api-1.4.0.min.js"></script>

	<style>
		p, .txt {  text-align: justify;
			 	text-justify: inter-word;
				}
	</style>

	<!-- Layout stylesheet -->
	<link rel="stylesheet" type="text/css" href="base.css">
	<style>
		html, body {
	        height: 100%;
	        margin: 0px;
	        background-color: rgba(97, 179, 179, 0.945);
	    }

		
	</style>
</head>
<body>
	<div class=test>
		<script>
			var svg = d3.select("body").append("svg")
			  .attr("width", 960)
			  .attr("height", 500)
			
			var image = {
			  size: 100
			}
			
			var defs = svg.append("defs");
			
			var clipPath = defs.append("clipPath")
			  .attr("id", "clip")
			  .append("circle")
			  .attr("cx", image.size / 2)
			  .attr("cy", image.size / 2)
			  .attr("r", image.size / 2);
			
			var glow = defs.append("filter")
				.attr("id", "glow");
			glow.append("feGaussianBlur")
			  .attr("class", "blur")
			  .attr("stdDeviation", 3.5)
			  .attr("result","coloredBlur");
			
			var feMergeGlow = glow.append("feMerge");
			feMergeGlow.append("feMergeNode")
			  .attr("in","coloredBlur");
			feMergeGlow.append("feMergeNode")
			  .attr("in","SourceGraphic");
			
			var doctorUrl1 = "praise.jpg",
				doctorUrl2 = "https://curbsideprophecies.files.wordpress.com/2007/08/davidolder.thumbnail.png",
				doctorUrl3 = "https://68.media.tumblr.com/avatar_fde0361fb75d_128.png",
				doctorUrl4 = "https://68.media.tumblr.com/avatar_91eba9afde80_128.png";
			
			appendDraggableImage(doctorUrl1, [70, 175]);
			appendDraggableImage(doctorUrl2, [310, 175]);
			appendDraggableImage(doctorUrl3, [550, 175]);
			appendDraggableImage(doctorUrl4, [790, 175]);
			
			function appendDraggableImage(url, position) {
			  var imageGroup = svg.append("g")
				  .datum({position: position})
				.attr("transform", d => "translate(" + d.position + ")");
		
			  var circleFill = imageGroup.append("circle")
				  .attr("class", "circle-fill")
				.attr("cx", image.size / 2)
				.attr("cy", image.size / 2 )
				.attr("r", image.size / 2)
				.attr("filter", "url(#glow");
		
			  var imageElem = imageGroup.append("image")
				.attr("xlink:href", url)
				.attr("height", image.size)
				.attr("width", image.size)
				.attr("clip-path", "url(#clip)");
			
			  var circleOutline = imageGroup.append("circle")
				.attr("class", "circle-outline")
				.attr("cx", image.size / 2)
				.attr("cy", image.size / 2 )
				.attr("r", 1 + image.size / 2);
		
			  imageGroup.call(d3.drag()
						.on("start", dragstarted)
						.on("drag", dragged)
						.on("end", dragended));
			  
			}
			
			function dragstarted(d) {
		//       d3.select(this).raise();
			  
		//       d3.select(this).select(".circle-outline")
		//       	.transition()
		//       	.attr("r", 1 + image.size / 3);
			  
		//       d3.select(this).select(".circle-fill")
		//       	.transition()
		//       	.attr("r", 1 + image.size / 3);
			  
		//       d3.select(this).select("image")
		//       	.attr("x", image.size / 6)
		//       	.attr("y", image.size / 6)
		//       	.attr("height", image.size * 2 / 3)
		//         .attr("width", image.size * 2 / 3)
			  
		//       clipPath.attr("r", image.size / 3)
			}
			
			function dragged(d) {
			  var newX = d3.event.x - image.size / 2,
				  newY = d3.event.y - image.size / 2; 
			  
			  d3.select(this)
				.attr("transform", "translate(" + (d.position = [newX, newY]) + ")");
			}
			
			function dragended(d) {
			  d3.select(this).lower();
			  
			}
			
		  </script>
	</div>
</body>
</html>
